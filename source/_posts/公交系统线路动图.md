---
title: 公交系统线路动图
date: 2021-12-15 12:06:27
categories:
    - Python数据分析
tags:
    - 公交路线
    - 百度Api
cover: /img/公交系统.jpg
---
关于调用百度API，能做的事情不仅仅这一个。可以随心所欲绘制自己想要的效果。


### 调用百度API
首先来这里注册一个秘钥

[百度地图开放平台](http://lbsyun.baidu.com/apiconsole/key#)

然后在控制台依次点击控制台-应用管理-我的应用-创建应用

![1639541677(1)](https://user-images.githubusercontent.com/59725125/146122125-cd6b79a8-5b8c-4c97-be75-f3edfcae3f8b.png)

创建一个浏览器端应用。复制生成的AK

如果是服务端，可以在cmd中输入ipconfig/all查看自己的IP地址

### 数据
我下载了echarts官方给的北京公交车地理数据

[下载地址](https://github.com/1250681923/picture.git)

想做什么应用就可以自己寻找数据，通常情况下地学数据共享平台等等能找到你想要的数据

### 代码

```
import json
with open('北京公交线路图.json','r') as f:
    datas=json.load(f)
result=[]
for data in datas:
    data = [float(i / 10000) for i in data]
    a=[]
    for i in range(2,len(data),2):
        data[i]=data[i-2]+data[i]
        data[i+1] = data[i - 1] + data[i+1]
        a.append([data[i],data[i+1]])
    result.append(a)
from pyecharts.charts import BMap
from pyecharts import options as opts
from pyecharts.faker import Faker

BAIDU_MAP_AK = "输入你自己的AK码"

c = (
    BMap(init_opts=opts.InitOpts(width="1200px", height="800px"))
    .add_schema(
        baidu_ak=BAIDU_MAP_AK,
        center=[116.40, 40.04],
        zoom=10,
        is_roam=True,
    )
    .add(
        "",
        type_="lines",
        is_polyline=True,
        data_pair=result,
        linestyle_opts=opts.LineStyleOpts(opacity=0.2, width=0.5,color='red'),
        # 如果不是最新版本的话可以注释下面的参数（效果差距不大）
        progressive=200,
        progressive_threshold=500,
    )
)
c.render_notebook()
```
效果如下：
![GIF 2021-12-15 12-21-23](https://user-images.githubusercontent.com/59725125/146122771-26ac6130-fcb9-4387-a492-a9fd3c142352.gif)
