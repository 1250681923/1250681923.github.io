{"title":"十、Kettle使用案例一 - txt与Excel交互","uid":"0c6a618c0d92b061d052cfc5d7dd0031","slug":"可视化ETL工具Kettle3","date":"2022-02-18T07:30:59.000Z","updated":"2022-02-18T08:20:01.260Z","comments":true,"path":"api/articles/可视化ETL工具Kettle3.json","keywords":null,"cover":"/img/Kettle3.jpg","content":"<h2 id=\"txt与Excel交互\"><a href=\"#txt与Excel交互\" class=\"headerlink\" title=\"txt与Excel交互\"></a>txt与Excel交互</h2><h3 id=\"1、需求\"><a href=\"#1、需求\" class=\"headerlink\" title=\"1、需求\"></a>1、需求</h3><ul>\n<li><p>将txt文件中的数据写入Excel表格中</p>\n<pre class=\"line-numbers language-hql\" data-language=\"hql\"><code class=\"language-hql\">id,name,age,gender,province,city,region,phone,birthday,hobby,register_date\n392456197008193000,张三,20,0,北京市,昌平区,回龙观,18589407692,1970-8-19,美食;篮球;足球,2018-8-6 9:44\n267456198006210000,李四,25,1,河南省,郑州市,郑东新区,18681109672,1980-6-21,音乐;阅读;旅游,2017-4-7 9:14\n892456199007203000,王五,24,1,湖北省,武汉市,汉阳区,18798009102,1990-7-20,写代码;读代码;算法,2016-6-8 7:34\n492456198712198000,赵六,26,2,陕西省,西安市,莲湖区,18189189195,1987-12-19,购物;旅游,2016-1-9 19:15\n392456197008193000,张三,20,0,北京市,昌平区,回龙观,18589407692,1970-8-19,美食;篮球;足球,2018-8-6 9:44\n392456197008193000,张三,20,0,北京市,昌平区,回龙观,18589407692,1970-8-19,美食;篮球;足球,2018-8-6 9:44</code></pre>\n<h3 id=\"2、分析\"><a href=\"#2、分析\" class=\"headerlink\" title=\"2、分析\"></a>2、分析</h3></li>\n<li><p>任务：一个转换程序</p>\n<ul>\n<li>输入：读取txt文件中内容</li>\n<li>转换：不需要</li>\n<li>输出：将内容加载到一个Excel文件中</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"3、实现\"><a href=\"#3、实现\" class=\"headerlink\" title=\"3、实现\"></a>3、实现</h3><ul>\n<li><p>step1：构建转换流程图</p>\n<ul>\n<li><p>新建一个转换任务</p>\n<ul>\n<li>有两种创建方式，要么双击转换，要么点文件-新建-转换。出来的页面：</li>\n</ul>\n<img width=\"865\" alt=\"6bc73de1d621c38c31fab1407f9b256\" src=\"https://user-images.githubusercontent.com/59725125/154639532-1ffe897e-d90a-4712-aa2d-00459dd088be.png\"></li>\n<li><p>将输入和输出拖入流程图的面板中。直接拖拽输入栏下的文本文件输入（因为是txt文件）。Excel 作为输出同理。</p>\n<img width=\"517\" alt=\"1645170844(1)\" src=\"https://user-images.githubusercontent.com/59725125/154641131-8ef5e5b4-8e02-4814-b67f-7d800a54cb5d.png\"></li>\n<li><p>连线： 选中文本文件输入，按住shift和鼠标左键，连接到Excel输出。</p>\n<img width=\"193\" alt=\"1645170935(1)\" src=\"https://user-images.githubusercontent.com/59725125/154641354-ccf8025c-0e41-403c-b892-adcee8a5e495.png\"></li>\n</ul>\n</li>\n<li><p>step2：配置输入</p>\n<ul>\n<li><p>关联文件：双击文本文件输入输出。改名字，浏览选中文件，然后点增加</p>\n<img width=\"485\" alt=\"1645171597(1)\" src=\"https://user-images.githubusercontent.com/59725125/154642918-2d1f3f77-fcac-442d-bfb9-216873fccbd1.png\"></li>\n<li><p>配置文件的格式：刚才的界面点击内容。根据分隔符的不同进行选择，如果有中文，编码格式改成UTF-8。</p>\n<img width=\"485\" alt=\"1645171818(1)\" src=\"https://user-images.githubusercontent.com/59725125/154643459-b3ef8de8-3816-4357-85fe-646a12228525.png\"></li>\n<li><p>选择输出到下一步的数据： 刚才界面选择字段，点击获取字段，确定就好。默认把第一行的名称作为列名。</p>\n<img width=\"485\" alt=\"1645171891(1)\" src=\"https://user-images.githubusercontent.com/59725125/154643640-539f62c8-bf18-4318-b987-3fa2f16293d8.png\">\n\n<p>:::warning<br>右键可以选择删除，上移下移<br>:::<br>也可以点击预览。没问题最终点确定。</p>\n<img width=\"466\" alt=\"1645172083(1)\" src=\"https://user-images.githubusercontent.com/59725125/154644062-96399400-7771-4193-a19f-3d4242ec29b3.png\"></li>\n</ul>\n</li>\n<li><p>step3：配置输出</p>\n<ul>\n<li>基本就改个地址就好。改个名字。</li>\n</ul>\n</li>\n<li><p>step4：测试运行</p>\n<ul>\n<li>点击运行就好。</li>\n</ul>\n</li>\n</ul>\n","feature":true,"text":"txt与Excel交互1、需求 将txt文件中的数据写入Excel表格中 id,name,age,gender,province,city,region,phone,birthday,hobby,register_date 392456197008193000,张三,20,0,北...","link":"","photos":[],"count_time":{"symbolsCount":"1.1k","symbolsTime":"1 mins."},"categories":[{"name":"BI商业大数据分析平台搭建","slug":"BI商业大数据分析平台搭建","count":11,"path":"api/categories/BI商业大数据分析平台搭建.json"}],"tags":[{"name":"大数据分析","slug":"大数据分析","count":11,"path":"api/tags/大数据分析.json"},{"name":"BI平台","slug":"BI平台","count":11,"path":"api/tags/BI平台.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#txt%E4%B8%8EExcel%E4%BA%A4%E4%BA%92\"><span class=\"toc-text\">txt与Excel交互</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1%E3%80%81%E9%9C%80%E6%B1%82\"><span class=\"toc-text\">1、需求</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2%E3%80%81%E5%88%86%E6%9E%90\"><span class=\"toc-text\">2、分析</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#3%E3%80%81%E5%AE%9E%E7%8E%B0\"><span class=\"toc-text\">3、实现</span></a></li></ol></li></ol>","author":{"name":"Quanito","slug":"blog-author","avatar":"/img/avatar.jpg","link":"/","description":"A little curious hunter","socials":{"github":"https://github.com/1250681923","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"GoogleMail":{"icon":"/img/googlemail.png","link":"mailto:code.quan666zhang@gmail.com"}}}},"mapped":true,"prev_post":{},"next_post":{"title":"九、Kettle部署及使用","uid":"7f7e4821e5cf8b5dfaeaf95aff63d8fe","slug":"可视化ETL工具Kettle2","date":"2022-01-29T12:19:11.000Z","updated":"2022-02-18T07:32:13.782Z","comments":true,"path":"api/articles/可视化ETL工具Kettle2.json","keywords":null,"cover":"/img/Kettle2.jpg","text":"Windows版本部署Kettle1、JDK安装配置 安装JDK 配置JDK环境变量 添加bin目录的位置。我安装的是jdk 1.8，这个版本没什么要求，尽量选取稳定的，不要那么新的版本。 验证安装的结果 在windows命令行执行 java -version 我的结果就是： C...","link":"","photos":[],"count_time":{"symbolsCount":786,"symbolsTime":"1 mins."},"categories":[{"name":"BI商业大数据分析平台搭建","slug":"BI商业大数据分析平台搭建","count":11,"path":"api/categories/BI商业大数据分析平台搭建.json"}],"tags":[{"name":"大数据分析","slug":"大数据分析","count":11,"path":"api/tags/大数据分析.json"},{"name":"BI平台","slug":"BI平台","count":11,"path":"api/tags/BI平台.json"}],"author":{"name":"Quanito","slug":"blog-author","avatar":"/img/avatar.jpg","link":"/","description":"A little curious hunter","socials":{"github":"https://github.com/1250681923","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"GoogleMail":{"icon":"/img/googlemail.png","link":"mailto:code.quan666zhang@gmail.com"}}}},"feature":true}}